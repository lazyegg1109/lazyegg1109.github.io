(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{452:function(s,t,a){s.exports=a.p+"assets/img/image-20220803143310988.d3d7d520.png"},453:function(s,t){s.exports="data:image/png;base64,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"},454:function(s,t,a){s.exports=a.p+"assets/img/image-20220803150107859.833a961e.png"},455:function(s,t,a){s.exports=a.p+"assets/img/image-20220803150816314.116a2719.png"},456:function(s,t,a){s.exports=a.p+"assets/img/image-20220803151943736.38cfa448.png"},457:function(s,t,a){s.exports=a.p+"assets/img/image-20220803152721884.93a070fd.png"},458:function(s,t,a){s.exports=a.p+"assets/img/image-20220803162548814.21a070ab.png"},526:function(s,t,a){"use strict";a.r(t);var n=a(3),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("SpringCloud Alibaba中的Gateway网关学习")])]),s._v(" "),t("h3",{attrs:{id:"为什么需要网关"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要网关"}},[s._v("#")]),s._v(" 为什么需要网关")]),s._v(" "),t("p",[t("img",{attrs:{src:a(452),alt:"image-20220803143310988"}})]),s._v(" "),t("p",[s._v("网关的功能：")]),s._v(" "),t("ul",[t("li",[s._v("身份认证和权限校验")]),s._v(" "),t("li",[s._v("服务路由、负载均衡")]),s._v(" "),t("li",[s._v("请求限流")])]),s._v(" "),t("h3",{attrs:{id:"网关的技术实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网关的技术实现"}},[s._v("#")]),s._v(" 网关的技术实现")]),s._v(" "),t("p",[s._v("SpringCloud中网关有两种：")]),s._v(" "),t("ul",[t("li",[s._v("gateway")]),s._v(" "),t("li",[s._v("zuul")])]),s._v(" "),t("p",[s._v("Zuul是基于Servlet的实现，属于阻塞式编程。")]),s._v(" "),t("p",[s._v("而SpringCloudGateway则是基于Spring5中提供的WebFlux，属于响应式编程的实现，具备更好的性能。")]),s._v(" "),t("h3",{attrs:{id:"搭建网关服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搭建网关服务"}},[s._v("#")]),s._v(" 搭建网关服务")]),s._v(" "),t("p",[s._v("1、创建新的模块来单独搭建gateway网关，先引入两个依赖：")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--网关依赖--\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-cloud-starter-gateway"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--nacos服务发现依赖--\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.alibaba.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("   \n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-cloud-starter-alibaba-nacos-discovery"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("创建启动类：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SpringBootApplication")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GatewayApplication")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpringApplication")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GatewayApplication")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("2、编写路由配置以及nacos地址")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10010")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网关端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gateway "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务名称")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos地址")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gateway")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("routes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网关路由配置")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路由id，自定义，只要唯一即可")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uri: http://127.0.0.1:8081 # 路由的目标地址 http就是固定地址")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" lb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//userservice "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路由的目标地址 lb就是负载均衡，后面跟服务名称")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("predicates")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路由断言，也就是判断请求是否符合路由规则的条件")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" Path=/user/"),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("**")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个是按照路径匹配，只要以/user/开头就符合要求")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("若要再代理多一个服务，则从-id开始，模仿第一个来添加：")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gateway")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("routes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网关路由配置")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路由id，自定义，只要唯一即可")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uri: http://127.0.0.1:8081 # 路由的目标地址 http就是固定地址")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" lb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//userservice "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路由的目标地址 lb就是负载均衡，后面跟服务名称")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("predicates")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路由断言，也就是判断请求是否符合路由规则的条件")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" Path=/user/"),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("**")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个是按照路径匹配，只要以/user/开头就符合要求")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" lb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//orderservice\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("predicates")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" Path=/order/"),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("**")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("启动服务后，直接访问网关的端口号加请求名称http://localhost:10010/user/1")]),s._v(" "),t("p",[s._v("请求成功：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(453),alt:"image-20220803145844136"}})]),s._v(" "),t("h3",{attrs:{id:"网关服务的流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网关服务的流程"}},[s._v("#")]),s._v(" 网关服务的流程")]),s._v(" "),t("p",[t("img",{attrs:{src:a(454),alt:"image-20220803150107859"}})]),s._v(" "),t("h3",{attrs:{id:"路由断言工厂-route-predicate-factory"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#路由断言工厂-route-predicate-factory"}},[s._v("#")]),s._v(" 路由断言工厂(Route Predicate Factory)")]),s._v(" "),t("p",[s._v("网关路由可以配置的内容包括：")]),s._v(" "),t("ul",[t("li",[s._v("路由id：路由唯一标示")]),s._v(" "),t("li",[s._v("uri：路由目的地，支持lb和http两种")]),s._v(" "),t("li",[s._v("predicates：路由断言，判断请求是否符合要求，符合则转发到路由目的地")]),s._v(" "),t("li",[s._v("filters：路由过滤器，处理请求或响应")])]),s._v(" "),t("p",[s._v("说明：")]),s._v(" "),t("ul",[t("li",[s._v("我们在配置文件中写的断言规则只是字符串，这些字符串会被Predicate Factory读取并处理，转变为路由判断的条件")]),s._v(" "),t("li",[s._v("例如Path=/user/**是按照路径匹配，这个规则是由org.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactory类来处理的")]),s._v(" "),t("li",[s._v("像这样的断言工厂在SpringCloudGateway还有十几个")])]),s._v(" "),t("p",[s._v("Spring提供了11中基本的Predicate工厂：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(455),alt:"image-20220803150816314"}})]),s._v(" "),t("p",[s._v("可以参照spring的官方网站，上面有对这些断言的使用讲解：")]),s._v(" "),t("p",[s._v("https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-request-predicates-factories")]),s._v(" "),t("p",[s._v("例子：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("predicates"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("order"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n            - After=2022-08-03T15:15:00.789+08:00[Asia/Shanghai]\n")])])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("这里选择了After断言规则，表示在这个时间之后的请求才能通过。否则会报404的错误。")]),s._v(" "),t("h3",{attrs:{id:"断言工厂小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#断言工厂小结"}},[s._v("#")]),s._v(" 断言工厂小结")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("PredicateFactory的作用是什么？")]),s._v(" "),t("p",[s._v("读取用户定义的断言条件，对请求做出判断")])]),s._v(" "),t("li",[t("p",[s._v("Path=/user/**是什么含义？")]),s._v(" "),t("p",[s._v("路径是以/user开头的就认为是符合的")])])]),s._v(" "),t("h3",{attrs:{id:"路由过滤器-gatewayfilter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#路由过滤器-gatewayfilter"}},[s._v("#")]),s._v(" 路由过滤器(GatewayFilter)")]),s._v(" "),t("p",[s._v("GatewayFilter是网关中提供的一种过滤器，可以对进入网关的请求和微服务返回的响应做处理：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(456),alt:"image-20220803151943736"}})]),s._v(" "),t("h3",{attrs:{id:"过滤器工厂-gatefilterfactory"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#过滤器工厂-gatefilterfactory"}},[s._v("#")]),s._v(" 过滤器工厂（GateFilterFactory）")]),s._v(" "),t("p",[s._v("参考spring官方地址：")]),s._v(" "),t("p",[s._v("https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gatewayfilter-factories")]),s._v(" "),t("p",[s._v("Spring提供了31种不同的过滤器，其中的有：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(457),alt:"image-20220803152721884"}})]),s._v(" "),t("h3",{attrs:{id:"配置过滤器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置过滤器"}},[s._v("#")]),s._v(" 配置过滤器")]),s._v(" "),t("p",[s._v("官方例子：")]),s._v(" "),t("h3",{attrs:{id:"the-addrequestheader-gatewayfilter-factory"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#the-addrequestheader-gatewayfilter-factory"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-addrequestheader-gatewayfilter-factory",target:"_blank",rel:"noopener noreferrer"}},[s._v("The "),t("code",[s._v("AddRequestHeader")]),s._v(" "),t("code",[s._v("GatewayFilter")]),s._v(" Factory"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gateway")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("routes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" add_request_header_route\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//example.org\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("filters")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" AddRequestHeader=X"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("red"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" blue\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("blockquote",[t("p",[s._v("This listing adds "),t("code",[s._v("X-Request-red:blue")]),s._v(" header to the downstream request’s headers for all matching requests.")])]),s._v(" "),t("blockquote",[t("p",[t("code",[s._v("AddRequestHeader")]),s._v(" is aware of the URI variables used to match a path or host. URI variables may be used in the value and are expanded at runtime. The following example configures an "),t("code",[s._v("AddRequestHeader")]),s._v(" "),t("code",[s._v("GatewayFilter")]),s._v(" that uses a variable:")])]),s._v(" "),t("p",[s._v("运用：")]),s._v(" "),t("p",[s._v("在配置文件中添加filters配置：")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("filters")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" AddRequestHeader=Truth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("LazyEgg is Awesome"),t("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("现在已经配置完成，如何在后端直接看到请求头的数据呢？")]),s._v(" "),t("p",[s._v("我们可以在controller层的接口中加上"),t("code",[s._v("@RequestHeader")]),s._v("的注解，这样就可以获取到指定的请求头中的参数：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/{id}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryById")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@PathVariable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Truth"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("required "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" truth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"truth:"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("truth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" userService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryById")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("这样的话，通过测试，确实可以拿到请求头信息。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("truth:LazyEgg is Awesome!\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"配置默认过滤器-所有路由"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置默认过滤器-所有路由"}},[s._v("#")]),s._v(" 配置默认过滤器(所有路由)")]),s._v(" "),t("p",[s._v("如果需要在所有路由上都配置相同的过滤器，则只需要在配置文件中配置default-filters，要注意，default-filters要与routes同级，这样就不会针对于某一个路由了，实现了所有路由过滤。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("default-filters")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" AddRequestHeader=Truth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("SleepyEgg is Awesome2！\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("这样的话，通过测试是可以实现的。")]),s._v(" "),t("h3",{attrs:{id:"过滤器工厂小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#过滤器工厂小结"}},[s._v("#")]),s._v(" 过滤器工厂小结")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("过滤器的作用是什么？")]),s._v(" "),t("p",[s._v("①对路由的请求或响应做加工处理，比如添加请求头")]),s._v(" "),t("p",[s._v("②配置在路由下的过滤器只对当前路由的请求生效")])]),s._v(" "),t("li",[t("p",[s._v("defaultFilters的作用是什么？")]),s._v(" "),t("p",[s._v("①对所有路由都生效的过滤器")])])]),s._v(" "),t("h3",{attrs:{id:"全局过滤器-globalfilter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#全局过滤器-globalfilter"}},[s._v("#")]),s._v(" 全局过滤器(GlobalFilter)")]),s._v(" "),t("p",[s._v("全局过滤器的作用也是处理一切进入网关的请求和微服务响应，与GatewayFilter的作用一样。")]),s._v(" "),t("p",[s._v("区别在于GatewayFilter通过配置定义，处理逻辑是固定的。而GlobalFilter的逻辑需要自己写代码实现。定义方式是实现GlobalFilter接口。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GlobalFilter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 处理当前请求，有必要的话通过{@link GatewayFilterChain}将请求交给下一个过滤器处理\n     *\n     * @param exchange 请求上下文，里面可以获取Request、Response等信息\n     * @param chain    用来把请求委托给下一个过滤器\n     * @return {@code Mono<Void>} 返回标示当前过滤器业务结束\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mono")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Void")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("filter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServerWebExchange")]),s._v(" exchange"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GatewayFilterChain")]),s._v(" chain"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("说明：Mono类型是属于Spring5中WebFlux，WebFlux是"),t("code",[s._v("Spring5.0+SpringBoot2.0+WebFlux")]),s._v("等技术开发的，属于响应式编程。")]),s._v(" "),t("h3",{attrs:{id:"全局过滤器实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#全局过滤器实例"}},[s._v("#")]),s._v(" 全局过滤器实例")]),s._v(" "),t("p",[s._v("目的：拦截判断用户身份")]),s._v(" "),t("p",[s._v("需求：定义全局过滤器，拦截请求，判断请求的参数是否满足下面条件：")]),s._v(" "),t("ul",[t("li",[s._v("参数中是否有authorization，")]),s._v(" "),t("li",[s._v("authorization参数值是否为admin如果")])]),s._v(" "),t("p",[s._v("同时满足则放行，否则拦截")]),s._v(" "),t("p",[s._v("代码实现：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cloud"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gateway"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("filter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GatewayFilterChain")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cloud"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gateway"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("filter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GlobalFilter")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordered")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpStatus")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reactive"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServerHttpRequest")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Component")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MultiValueMap")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServerWebExchange")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("reactor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("publisher"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mono")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @Author 早睡蛋\n * @Date 2022/8/3 16:01:16\n * @Desc:\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//@Order(-1)过滤器的顺序，也可以实现Ordered接口方法进行设置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AuthorizeFilter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GlobalFilter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordered")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mono")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Void")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("filter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServerWebExchange")]),s._v(" exchange"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GatewayFilterChain")]),s._v(" chain"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//1.获取请求参数")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServerHttpRequest")]),s._v(" request "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" exchange"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MultiValueMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" params "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getQueryParams")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//2.获取参数中的 authorization 参数")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" auth "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getFirst")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"authorization"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//getFirst为取出第一个匹配的")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//3.判断参数数值是否等于 admin")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("auth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//4.是：放行")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" chain"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("filter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exchange"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//chain是链，会从过滤器链中找到下一个过滤器，等于放行")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//5.否：拦截")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//5.1.设置状态码")]),s._v("\n        exchange"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getResponse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStatusCode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UNAUTHORIZED"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//setStatusCode要传枚举类，UNAUTHORIZED为401，未登录的意思")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//5.2.拦截请求")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" exchange"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getResponse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setComplete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//过滤器执行的顺序")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br")])]),t("p",[s._v('再次发起请求，浏览器会报401（也就是我们自定义设置的未登录错误），若在请求中加上"?authorization=admin"则会访问成功。')]),s._v(" "),t("h3",{attrs:{id:"过滤器执行顺序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#过滤器执行顺序"}},[s._v("#")]),s._v(" 过滤器执行顺序")]),s._v(" "),t("p",[s._v("请求进入网关会碰到三类过滤器：当前路由的过滤器、DefaultFilter、GlobalFilter请求路由后，会将当前路由过滤器和DefaultFilter、GlobalFilter，合并到一个过滤器链（集合）中，排序后依次执行每个过滤器")]),s._v(" "),t("p",[t("img",{attrs:{src:a(458),alt:"image-20220803162548814"}})]),s._v(" "),t("ul",[t("li",[s._v("每一个过滤器都必须指定一个int类型的order值，order值越小，优先级越高，执行顺序越靠前。")]),s._v(" "),t("li",[s._v("GlobalFilter通过实现Ordered接口，或者添加@Order注解来指定order值，由我们自己指定")]),s._v(" "),t("li",[s._v("路由过滤器和defaultFilter的order由Spring指定，默认是按照声明顺序从1递增。当过滤器的order值一样时，会按照 defaultFilter > 路由过滤器 > GlobalFilter的顺序执行。")])]),s._v(" "),t("p",[s._v("可以参考下面几个类的源码来查看：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cloud"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gateway"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("route"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("RouteDefinitionRouteLocator")]),s._v("#"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getFilters")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("方法是先加载defaultFilters，然后再加载某个route的filters，然后合并。\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cloud"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gateway"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("FilteringWebHandler")]),s._v("#"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("handle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("方法会加载全局过滤器，与前面的过滤器合并后根据order排序，组织过滤器链\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"网关cors跨域处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网关cors跨域处理"}},[s._v("#")]),s._v(" 网关Cors跨域处理")]),s._v(" "),t("p",[s._v("跨域：域名不一致就是跨域，主要包括：")]),s._v(" "),t("ul",[t("li",[s._v("域名不同： www.taobao.com 和 www.taobao.org 和 www.jd.com 和 miaosha.jd.com")]),s._v(" "),t("li",[s._v("域名相同，端口不同：localhost:8080和localhost8081")])]),s._v(" "),t("p",[s._v("跨域问题："),t("strong",[s._v("浏览器")]),s._v("禁止请求的发起者与服务端发生跨域"),t("strong",[s._v("ajax请求")]),s._v("，请求被浏览器拦截的问题")]),s._v(" "),t("p",[s._v("解决方案：CORS")]),s._v(" "),t("h3",{attrs:{id:"cors跨域配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cors跨域配置"}},[s._v("#")]),s._v(" CORS跨域配置")]),s._v(" "),t("p",[s._v("参照官网：https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#cors-configuration")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gateway")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("globalcors")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cors-configurations")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("'[/**]'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allowedOrigins")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docs.spring.io"')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allowedMethods")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" GET\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("注意：针对OPTIONS请求被拦截的问题，需要在上述配置中再加一条"),t("code",[s._v("add-to-simple-url-handler-mapping: true")])]),s._v(" "),t("blockquote",[t("p",[s._v("To provide the same CORS configuration to requests that are not handled by some gateway route predicate, set the "),t("code",[s._v("spring.cloud.gateway.globalcors.add-to-simple-url-handler-mapping")]),s._v(" property to "),t("code",[s._v("true")]),s._v(". This is useful when you try to support CORS preflight requests and your route predicate does not evalute to "),t("code",[s._v("true")]),s._v(" because the HTTP method is "),t("code",[s._v("options")]),s._v(".")])]),s._v(" "),t("h4",{attrs:{id:"配置详情"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置详情"}},[s._v("#")]),s._v(" 配置详情")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gateway")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("globalcors")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局的跨域处理")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("add-to-simple-url-handler-mapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解决options请求被拦截问题")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("corsConfigurations")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("'[/**]'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拦截哪一些请求")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allowedOrigins")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许哪些网站的跨域请求")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost:8090"')]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://www.baidu.com"')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allowedMethods")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许的跨域ajax的请求方式")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET"')]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"POST"')]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DELETE"')]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PUT"')]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OPTIONS"')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allowedHeaders")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许在请求中携带的头信息")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allowCredentials")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否允许携带cookie")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxAge")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("360000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这次跨域检测的有效期")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);